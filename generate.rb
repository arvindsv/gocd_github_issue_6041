#!/usr/bin/env ruby

number_of_pipeline_runs = ARGV[0].to_i || 100

def timestamp prefix, value
  sprintf("%07d", value).sub(/(..)(..)(...)/, "#{prefix}:\\1:\\2.\\3")
end

# Part 1: Pipeline label counts
pipeline_label_counts = <<-EOF
INSERT INTO PUBLIC.PIPELINELABELCOUNTS(ID, PIPELINENAME, LABELCOUNT, PAUSE_CAUSE, PAUSE_BY, PAUSED, CASEINSENSITIVEPIPELINENAME) VALUES
(1, 'CreditDriver-Build', #{number_of_pipeline_runs}, NULL, NULL, FALSE, CAST('CreditDriver-Build' AS VARCHAR_IGNORECASE));
EOF

# Part 2: BSTs
bsts = (1 .. number_of_pipeline_runs).collect do |index|
  [
    "(#{index * 2 - 1}, 'Scheduled', TIMESTAMP '#{timestamp('2019-04-10 17', (index * 2 - 1))}', #{index}, #{index})",
    "(#{index * 2}, 'Completed', TIMESTAMP '#{timestamp('2019-04-10 17', (index * 2))}', #{index}, #{index})",
  ]
end.flatten

build_state_transitions = "INSERT INTO PUBLIC.BUILDSTATETRANSITIONS(ID, CURRENTSTATE, STATECHANGETIME, BUILDID, STAGEID) VALUES\n" + bsts.join(",\n") + ";"

# Part 3: Builds (jobs)
build_values = (1 .. number_of_pipeline_runs).collect do |index|
  "(#{index}, CAST('defaultJob' AS VARCHAR_IGNORECASE), 'Completed', 'Cancelled', NULL, TIMESTAMP '#{timestamp('2019-04-10 17', index * 2)}', #{index}, FALSE, FALSE, NULL, FALSE, FALSE)"
end

builds = "INSERT INTO PUBLIC.BUILDS(ID, NAME, STATE, RESULT, AGENTUUID, SCHEDULEDDATE, STAGEID, IGNORED, RUNONALLAGENTS, ORIGINALJOBID, RERUN, RUNMULTIPLEINSTANCE) VALUES\n" +
         build_values.join(",\n") + ";"


# Part 4: PMRs
pipeline_material_revisions = "INSERT INTO PUBLIC.PIPELINEMATERIALREVISIONS(ID, FOLDER, NAME, PIPELINEID, TOREVISIONID, FROMREVISIONID, CHANGED, MATERIALID, ACTUALFROMREVISIONID) VALUES\n" + (1 .. number_of_pipeline_runs).collect do |index|
  "(#{index}, NULL, NULL, #{index}, 1, 1, TRUE, 1, 1)"
end.join(",\n") + ";"


# Part 5: Stages
stages = "INSERT INTO PUBLIC.STAGES(ID, NAME, APPROVEDBY, PIPELINEID, CREATEDTIME, ORDERID, RESULT, APPROVALTYPE, COUNTER, COMPLETEDBYTRANSITIONID, STATE, LATESTRUN, FETCHMATERIALS, CLEANWORKINGDIR, RERUNOFCOUNTER, ARTIFACTSDELETED, CONFIGVERSION, LASTTRANSITIONEDTIME, CANCELLEDBY) VALUES\n" +
         (1 .. number_of_pipeline_runs).collect do |index|
  "(#{index}, CAST('ExtractCIcomponents' AS VARCHAR_IGNORECASE), 'changes', #{index}, TIMESTAMP '#{timestamp('2019-04-10 17', index * 2)}', 1, 'Cancelled', 'success', 1, #{index * 2}, 'Cancelled', TRUE, TRUE, FALSE, NULL, FALSE, '7196b8fdfaa6dc2fb7ed105bf24d969d', TIMESTAMP '#{timestamp('2019-04-10 17', index * 2)}', 'anonymous')"
end.join(",\n") + ";"

# Part 6: Pipelines
pipelines = "INSERT INTO PUBLIC.PIPELINES(ID, NAME, BUILDCAUSETYPE, BUILDCAUSEBY, LABEL, BUILDCAUSEMESSAGE, COUNTER, NATURALORDER, COMMENT) VALUES\n" +
            (1 .. number_of_pipeline_runs).collect do |index|
  "(#{index}, CAST('CreditDriver-Build' AS VARCHAR_IGNORECASE), 'ManualForcedBuildCause', NULL, '#{index}', 'Forced by anonymous', #{index}, #{index}.0, NULL)"
end.join(",\n") + ";"


parts = DATA.read.split('---###--- END PART')

puts parts[0] +
     pipeline_label_counts +
     parts[1] +
     build_state_transitions +
     parts[2] +
     builds +
     parts[3] +
     pipeline_material_revisions +
     parts[4] +
     stages +
     parts[5] +
     pipelines +
     parts[6]


__END__
SET DB_CLOSE_DELAY -1;
SET TRACE_MAX_FILE_SIZE 16;
SET CACHE_SIZE 131072;
CREATE USER IF NOT EXISTS SA SALT '16b1989f1d907947' HASH 'b93c73230fc82bf3aa4f75aafa5f49750fdebdcc7713b389ee17048920656a80' ADMIN;
CREATE FORCE ALIAS PUBLIC.ADDCOLUMNIFABSENT FOR "com.thoughtworks.go.server.sqlmigration.Migration_230001.createColumnIfNotExist";
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_4621E914_4722_4350_BEC2_9C3D2548711C START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_DB2104E0_FA01_41B6_B6D6_373CE3C83115 START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_6FE8DA54_7879_4B40_B9BB_6FEB68DC347C START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_6D485518_4624_4E49_8846_9B0D98ED963F START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_D59DAD6C_A077_475F_BF21_0833E86E1905 START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_E2899526_367C_49D4_83C8_A973FB1DA871 START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_F9C99765_8C5C_4471_A80F_17ABEE7B4F15 START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_30D677D9_81BA_48CB_8C8C_1EB13EBF791A START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_77FF5032_016F_4D53_A95A_A236BBA2DC36 START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_9BF9FCB2_4A4B_4C5E_9765_A038AB75CFC7 START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_735ED142_BD5A_4A5D_A206_3F947F7C87BF START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_31D4A714_2D67_4C29_B8B6_2620565E132A START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_CA3CAD59_1BD9_439B_9B57_3F60DB954F32 START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_AB3E7DF6_D685_45AD_8F38_A6EEA3B818EB START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_16F8250C_9C41_4867_ADF4_0D1E0E7AAF2A START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_0BFD76F0_F363_4ADF_9BE4_7EBF92197424 START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_8673CDBC_F34A_40FA_B0A9_4EE8412C845D START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_9EC6977A_6B2A_4639_A83D_9854838EBC5B START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_11D050F4_D2DE_481A_90D0_AF7E4B9A5484 START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_2A78E877_65C6_495B_98C3_FC214665B25F START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_C32C24B0_2181_48AE_8C5A_531B7E368282 START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_6BCBD774_62B1_4BEA_8D05_6D361E4F88CD START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_AD1357FE_A393_4845_8812_964C3301BD20 START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_76F9B884_07A3_4F90_A347_39402C0A5C72 START WITH 33 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_70301CFF_3E94_4F4F_9584_20786524A18F START WITH 1 BELONGS_TO_TABLE;
CREATE SEQUENCE PUBLIC.SYSTEM_SEQUENCE_A7425CE1_4C3A_478E_8F4B_8A45996C4A3B START WITH 33 BELONGS_TO_TABLE;
CREATE CACHED TABLE PUBLIC.CHANGELOG(
    CHANGE_NUMBER INTEGER NOT NULL,
    DELTA_SET VARCHAR(10) NOT NULL,
    START_DT TIMESTAMP NOT NULL,
    COMPLETE_DT TIMESTAMP,
    APPLIED_BY VARCHAR(100) NOT NULL,
    DESCRIPTION VARCHAR(500) NOT NULL
);
ALTER TABLE PUBLIC.CHANGELOG ADD CONSTRAINT PUBLIC.PKCHANGELOG PRIMARY KEY(CHANGE_NUMBER, DELTA_SET);
-- 162 +/- SELECT COUNT(*) FROM PUBLIC.CHANGELOG;
INSERT INTO PUBLIC.CHANGELOG(CHANGE_NUMBER, DELTA_SET, START_DT, COMPLETE_DT, APPLIED_BY, DESCRIPTION) VALUES
(1, 'DDL', TIMESTAMP '2019-04-10 17:01:42.595', TIMESTAMP '2019-04-10 17:01:42.664', 'SA', '1_create_initial_tables.sql'),
(2, 'DDL', TIMESTAMP '2019-04-10 17:01:42.667', TIMESTAMP '2019-04-10 17:01:42.682', 'SA', '2_create_indexes.sql'),
(3, 'DDL', TIMESTAMP '2019-04-10 17:01:42.685', TIMESTAMP '2019-04-10 17:01:42.702', 'SA', '3_add_build_ignored_column.sql'),
(4, 'DDL', TIMESTAMP '2019-04-10 17:01:42.705', TIMESTAMP '2019-04-10 17:01:42.717', 'SA', '4_add_check_externals_column.sql'),
(5, 'DDL', TIMESTAMP '2019-04-10 17:01:42.723', TIMESTAMP '2019-04-10 17:01:42.747', 'SA', '5_add_from_external_column.sql'),
(6, 'DDL', TIMESTAMP '2019-04-10 17:01:42.749', TIMESTAMP '2019-04-10 17:01:42.764', 'SA', '6_add_pipeline_label.sql'),
(7, 'DDL', TIMESTAMP '2019-04-10 17:01:42.767', TIMESTAMP '2019-04-10 17:01:42.774', 'SA', '7_add_pipeline_label_counters.sql'),
(8, 'DDL', TIMESTAMP '2019-04-10 17:01:42.776', TIMESTAMP '2019-04-10 17:01:42.782', 'SA', '8_add_build_cause_buffer.sql'),
(9, 'DDL', TIMESTAMP '2019-04-10 17:01:42.785', TIMESTAMP '2019-04-10 17:01:42.792', 'SA', '9_add_material_properties_table.sql'),
(10, 'DDL', TIMESTAMP '2019-04-10 17:01:42.794', TIMESTAMP '2019-04-10 17:01:42.8', 'SA', '10_add_stage_timestamp.sql'),
(11, 'DDL', TIMESTAMP '2019-04-10 17:01:42.803', TIMESTAMP '2019-04-10 17:01:42.812', 'SA', '11_add_stage_order.sql'),
(12, 'DDL', TIMESTAMP '2019-04-10 17:01:42.814', TIMESTAMP '2019-04-10 17:01:42.83', 'SA', '12_add_stage_result.sql'),
(13, 'DDL', TIMESTAMP '2019-04-10 17:01:42.833', TIMESTAMP '2019-04-10 17:01:42.862', 'SA', '13_add_stage_approvalType.sql'),
(14, 'DDL', TIMESTAMP '2019-04-10 17:01:42.865', TIMESTAMP '2019-04-10 17:01:42.869', 'SA', '14_add_name_pipelineId_index_for_stages.sql'),
(15, 'DDL', TIMESTAMP '2019-04-10 17:01:42.872', TIMESTAMP '2019-04-10 17:01:42.875', 'SA', '15_add_name_agentId_buildid_index_for_builds.sql'),
(16, 'DDL', TIMESTAMP '2019-04-10 17:01:42.878', TIMESTAMP '2019-04-10 17:01:42.884', 'SA', '16_add_folder_to_materials.sql'),
(17, 'DDL', TIMESTAMP '2019-04-10 17:01:42.886', TIMESTAMP '2019-04-10 17:01:42.902', 'SA', '17_correct_integrity_issues_in_stages.sql'),
(18, 'DDL', TIMESTAMP '2019-04-10 17:01:42.904', TIMESTAMP '2019-04-10 17:01:42.908', 'SA', '18_change_material_properties_value_to_nvarchar.sql'),
(19, 'DDL', TIMESTAMP '2019-04-10 17:01:42.91', TIMESTAMP '2019-04-10 17:01:42.914', 'SA', '19_change_material_url_to_nvarchar.sql'),
(20, 'DDL', TIMESTAMP '2019-04-10 17:01:42.917', TIMESTAMP '2019-04-10 17:01:42.923', 'SA', '20_add_artifact_properties_generator_table.sql'),
(21, 'DDL', TIMESTAMP '2019-04-10 17:01:42.925', TIMESTAMP '2019-04-10 17:01:42.939', 'SA', '21_add_materialId_to_modifications.sql'),
(22, 'DDL', TIMESTAMP '2019-04-10 17:01:42.942', TIMESTAMP '2019-04-10 17:01:42.948', 'SA', '22_remove_pipelineId_from_modifications.sql'),
(23, 'DDL', TIMESTAMP '2019-04-10 17:01:42.95', TIMESTAMP '2019-04-10 17:01:42.96', 'SA', '23_add_index_for_stages.sql'),
(24, 'DDL', TIMESTAMP '2019-04-10 17:01:42.962', TIMESTAMP '2019-04-10 17:01:42.975', 'SA', '24_add_columns_for_dependency_materials.sql'),
(25, 'DDL', TIMESTAMP '2019-04-10 17:01:42.98', TIMESTAMP '2019-04-10 17:01:42.987', 'SA', '25_change_length_of_revision_to_1024_for_modifications.sql'),
(26, 'DDL', TIMESTAMP '2019-04-10 17:01:42.991', TIMESTAMP '2019-04-10 17:01:42.998', 'SA', '26_add_table_fetch_artifact_plans.sql'),
(27, 'DDL', TIMESTAMP '2019-04-10 17:01:43.003', TIMESTAMP '2019-04-10 17:01:43.044', 'SA', '27_set_not_null_on_fetch_artifact_plans.sql'),
(28, 'DDL', TIMESTAMP '2019-04-10 17:01:43.047', TIMESTAMP '2019-04-10 17:01:43.05', 'SA', '28_drop_table_fetch_artifacts.sql'),
(29, 'DDL', TIMESTAMP '2019-04-10 17:01:43.052', TIMESTAMP '2019-04-10 17:01:43.078', 'SA', '29_fix_hsqldb_migration.sql'),
(30, 'DDL', TIMESTAMP '2019-04-10 17:01:43.08', TIMESTAMP '2019-04-10 17:01:43.085', 'SA', '30_add_buildcause_message_to_pipeline.sql'),
(31, 'DDL', TIMESTAMP '2019-04-10 17:01:43.087', TIMESTAMP '2019-04-10 17:01:43.091', 'SA', '31_add_user_setting.sql');
INSERT INTO PUBLIC.CHANGELOG(CHANGE_NUMBER, DELTA_SET, START_DT, COMPLETE_DT, APPLIED_BY, DESCRIPTION) VALUES
(32, 'DDL', TIMESTAMP '2019-04-10 17:01:43.093', TIMESTAMP '2019-04-10 17:01:43.097', 'SA', '32_add_email_me_column.sql'),
(33, 'DDL', TIMESTAMP '2019-04-10 17:01:43.099', TIMESTAMP '2019-04-10 17:01:43.102', 'SA', '33_add_unique_constraint_to_name_column_on_usersettings.sql'),
(34, 'DDL', TIMESTAMP '2019-04-10 17:01:43.104', TIMESTAMP '2019-04-10 17:01:43.11', 'SA', '34_add_changed_column_to_modifications.sql'),
(35, 'DDL', TIMESTAMP '2019-04-10 17:01:43.112', TIMESTAMP '2019-04-10 17:01:43.115', 'SA', '35_rename_usersettings_table.sql'),
(36, 'DDL', TIMESTAMP '2019-04-10 17:01:43.117', TIMESTAMP '2019-04-10 17:01:43.122', 'SA', '36_add_notificationfilters_table.sql'),
(37, 'DDL', TIMESTAMP '2019-04-10 17:01:43.124', TIMESTAMP '2019-04-10 17:01:43.126', 'SA', '37_make_the_pipeline_name_case_insensitive.sql'),
(38, 'DDL', TIMESTAMP '2019-04-10 17:01:43.128', TIMESTAMP '2019-04-10 17:01:43.13', 'SA', '38_make_the_stage_name_case_insensitive.sql'),
(39, 'DDL', TIMESTAMP '2019-04-10 17:01:43.132', TIMESTAMP '2019-04-10 17:01:43.134', 'SA', '39_make_the_job_name_case_insensitive.sql'),
(40, 'DDL', TIMESTAMP '2019-04-10 17:01:43.136', TIMESTAMP '2019-04-10 17:01:43.138', 'SA', '40_undo_pipelines_case_insensitive_change.sql'),
(41, 'DDL', TIMESTAMP '2019-04-10 17:01:43.141', TIMESTAMP '2019-04-10 17:01:43.145', 'SA', '41_add_builds_index_on_name_state_and_stageid.sql'),
(42, 'DDL', TIMESTAMP '2019-04-10 17:01:43.147', TIMESTAMP '2019-04-10 17:01:43.154', 'SA', '42_add_counter_to_pipelines.sql'),
(43, 'DDL', TIMESTAMP '2019-04-10 17:01:43.156', TIMESTAMP '2019-04-10 17:01:43.16', 'SA', '43_alter_modifiedFiles_fileName.sql'),
(44, 'DDL', TIMESTAMP '2019-04-10 17:01:43.162', TIMESTAMP '2019-04-10 17:01:43.192', 'SA', '44_added_name_column_into_material.sql'),
(45, 'DDL', TIMESTAMP '2019-04-10 17:01:43.194', TIMESTAMP '2019-04-10 17:01:43.2', 'SA', '45_remove_matcher_from_builds.sql'),
(46, 'DDL', TIMESTAMP '2019-04-10 17:01:43.202', TIMESTAMP '2019-04-10 17:01:43.224', 'SA', '46_remove_material_properties.sql'),
(47, 'DDL', TIMESTAMP '2019-04-10 17:01:43.226', TIMESTAMP '2019-04-10 17:01:43.311', 'SA', '47_create_new_materials.sql'),
(48, 'DDL', TIMESTAMP '2019-04-10 17:01:43.313', TIMESTAMP '2019-04-10 17:01:43.319', 'SA', '48_add_name_to_material_instance.sql'),
(49, 'DDL', TIMESTAMP '2019-04-10 17:01:43.321', TIMESTAMP '2019-04-10 17:01:43.324', 'SA', '49_add_unique_constraint_to_revisions.sql'),
(50, 'DDL', TIMESTAMP '2019-04-10 17:01:43.326', TIMESTAMP '2019-04-10 17:01:43.331', 'SA', '50_add_run_on_all_agents_to_builds.sql'),
(51, 'DDL', TIMESTAMP '2019-04-10 17:01:43.333', TIMESTAMP '2019-04-10 17:01:43.336', 'SA', '51_add_environment_variable_properties.sql'),
(52, 'DDL', TIMESTAMP '2019-04-10 17:01:43.338', TIMESTAMP '2019-04-10 17:01:43.342', 'SA', '52_add_pipeline_lock.sql'),
(53, 'DDL', TIMESTAMP '2019-04-10 17:01:43.344', TIMESTAMP '2019-04-10 17:01:43.365', 'SA', '53_add_index_on_pipelines_locked.sql'),
(54, 'DDL', TIMESTAMP '2019-04-10 17:01:43.366', TIMESTAMP '2019-04-10 17:01:43.372', 'SA', '54_add_stage_id_to_build_transitions.sql'),
(55, 'DDL', TIMESTAMP '2019-04-10 17:01:43.374', TIMESTAMP '2019-04-10 17:01:43.383', 'SA', '55_add_completed_at_transition_id_to_stages.sql'),
(56, 'DDL', TIMESTAMP '2019-04-10 17:01:43.385', TIMESTAMP '2019-04-10 17:01:43.388', 'SA', '56_create_index_on_environment_variables_job_id.sql'),
(57, 'DDL', TIMESTAMP '2019-04-10 17:01:43.39', TIMESTAMP '2019-04-10 17:01:43.396', 'SA', '57_add_state_to_stage.sql'),
(58, 'DDL', TIMESTAMP '2019-04-10 17:01:43.397', TIMESTAMP '2019-04-10 17:01:43.402', 'SA', '58_add_natural_order_to_pipelines.sql'),
(59, 'DDL', TIMESTAMP '2019-04-10 17:01:43.404', TIMESTAMP '2019-04-10 17:01:43.407', 'SA', '59_create_index_on_stages_state.sql'),
(60, 'DDL', TIMESTAMP '2019-04-10 17:01:43.408', TIMESTAMP '2019-04-10 17:01:43.414', 'SA', '60_support_for_variables_at_different_levels.sql'),
(61, 'DDL', TIMESTAMP '2019-04-10 17:01:43.416', TIMESTAMP '2019-04-10 17:01:43.421', 'SA', '61_migrate_old_pipelines_to_have_counter.sql');
INSERT INTO PUBLIC.CHANGELOG(CHANGE_NUMBER, DELTA_SET, START_DT, COMPLETE_DT, APPLIED_BY, DESCRIPTION) VALUES
(62, 'DDL', TIMESTAMP '2019-04-10 17:01:43.422', TIMESTAMP '2019-04-10 17:01:43.479', 'SA', '62_migrate_dependency_modifications_to_use_pipeline_counter_based_stage_locator.sql'),
(63, 'DDL', TIMESTAMP '2019-04-10 17:01:43.48', TIMESTAMP '2019-04-10 17:01:43.491', 'SA', '63_add_schedule_to_and_from_revisions.sql'),
(64, 'DDL', TIMESTAMP '2019-04-10 17:01:43.493', TIMESTAMP '2019-04-10 17:01:43.513', 'SA', '64_populate_missing_pipeline_label_in_modifications.sql'),
(65, 'DDL', TIMESTAMP '2019-04-10 17:01:43.515', TIMESTAMP '2019-04-10 17:01:43.525', 'SA', '65_repoint_FROM_to_TO_for_dependency_pmr.sql'),
(66, 'DDL', TIMESTAMP '2019-04-10 17:01:43.526', TIMESTAMP '2019-04-10 17:01:43.55', 'SA', '66_remove_schedule_to_and_from_revisions.sql'),
(67, 'DDL', TIMESTAMP '2019-04-10 17:01:43.552', TIMESTAMP '2019-04-10 17:01:43.555', 'SA', '67_create_pipeline_selections_table.sql'),
(68, 'DDL', TIMESTAMP '2019-04-10 17:01:43.557', TIMESTAMP '2019-04-10 17:01:43.56', 'SA', '68_add_foreign_key_from_pmr_to_pipeline.sql'),
(69, 'DDL', TIMESTAMP '2019-04-10 17:01:43.562', TIMESTAMP '2019-04-10 17:01:43.565', 'SA', '69_create_index_on_builds_name_and_stage_id.sql'),
(70, 'DDL', TIMESTAMP '2019-04-10 17:01:43.567', TIMESTAMP '2019-04-10 17:01:43.577', 'SA', '70_change_pipeline_stage_and_job_name_to_varchar_ignorecase.sql'),
(71, 'DDL', TIMESTAMP '2019-04-10 17:01:43.578', TIMESTAMP '2019-04-10 17:01:43.587', 'SA', '71_add_latest_run_flag_on_stage.sql'),
(72, 'DDL', TIMESTAMP '2019-04-10 17:01:43.588', TIMESTAMP '2019-04-10 17:01:43.591', 'SA', '72_create_builds_view.sql'),
(73, 'DDL', TIMESTAMP '2019-04-10 17:01:43.593', TIMESTAMP '2019-04-10 17:01:43.595', 'SA', '73_create_stages_view.sql'),
(74, 'DDL', TIMESTAMP '2019-04-10 17:01:43.597', TIMESTAMP '2019-04-10 17:01:43.6', 'SA', '74_add_unique_constraint_for_stages_on_pipelineId_name_counter.sql'),
(75, 'DDL', TIMESTAMP '2019-04-10 17:01:43.601', TIMESTAMP '2019-04-10 17:01:43.604', 'SA', '75_create_agent_cookie_mapping_table.sql'),
(76, 'DDL', TIMESTAMP '2019-04-10 17:01:43.605', TIMESTAMP '2019-04-10 17:01:43.612', 'SA', '76_create_oauth_tables.sql'),
(77, 'DDL', TIMESTAMP '2019-04-10 17:01:43.613', TIMESTAMP '2019-04-10 17:01:43.62', 'SA', '77_add_enabled_to_users.sql'),
(78, 'DDL', TIMESTAMP '2019-04-10 17:01:43.621', TIMESTAMP '2019-04-10 17:01:43.629', 'SA', '78_add_fetchMaterials_to_stages.sql'),
(79, 'DDL', TIMESTAMP '2019-04-10 17:01:43.63', TIMESTAMP '2019-04-10 17:01:43.636', 'SA', '79_recreate_build_and_stages_views.sql'),
(80, 'DDL', TIMESTAMP '2019-04-10 17:01:43.638', TIMESTAMP '2019-04-10 17:01:43.645', 'SA', '80_add_cleanWorkingDir_to_stages.sql'),
(81, 'DDL', TIMESTAMP '2019-04-10 17:01:43.646', TIMESTAMP '2019-04-10 17:01:43.652', 'SA', '81_recreate_build_and_stages_views.sql'),
(82, 'DDL', TIMESTAMP '2019-04-10 17:01:43.653', TIMESTAMP '2019-04-10 17:01:43.655', 'SA', '82_make_oauth_client_names_unique.sql'),
(83, 'DDL', TIMESTAMP '2019-04-10 17:01:43.656', TIMESTAMP '2019-04-10 17:01:43.664', 'SA', '83_create_gadget_oauth_tables.sql'),
(84, 'DDL', TIMESTAMP '2019-04-10 17:01:43.665', TIMESTAMP '2019-04-10 17:01:43.69', 'SA', '84_add_pipelineId_to_modifications.sql'),
(85, 'DDL', TIMESTAMP '2019-04-10 17:01:43.691', TIMESTAMP '2019-04-10 17:01:43.696', 'SA', '85_add_materialId_to_pipelineMaterialRevisions.sql'),
(86, 'DDL', TIMESTAMP '2019-04-10 17:01:43.698', TIMESTAMP '2019-04-10 17:01:43.717', 'SA', '86_add_actual_from_revision_to_pmr.sql'),
(87, 'DDL', TIMESTAMP '2019-04-10 17:01:43.718', TIMESTAMP '2019-04-10 17:01:43.719', 'SA', '87_create_index_modifications_materialId.sql'),
(88, 'DDL', TIMESTAMP '2019-04-10 17:01:43.72', TIMESTAMP '2019-04-10 17:01:43.743', 'SA', '88_rerun_to_actual_job_mapping.sql'),
(89, 'DDL', TIMESTAMP '2019-04-10 17:01:43.746', TIMESTAMP '2019-04-10 17:01:43.758', 'SA', '89_adding_rerun_of_counter_for_rerun_job_stages.sql'),
(90, 'DDL', TIMESTAMP '2019-04-10 17:01:43.759', TIMESTAMP '2019-04-10 17:01:43.778', 'SA', '90_populate_missing_completed_at_transition_id.sql');
INSERT INTO PUBLIC.CHANGELOG(CHANGE_NUMBER, DELTA_SET, START_DT, COMPLETE_DT, APPLIED_BY, DESCRIPTION) VALUES
(221001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.78', TIMESTAMP '2019-04-10 17:01:43.79', 'SA', '221001_fix_incomplete_stages_and_jobs.sql'),
(230001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.791', TIMESTAMP '2019-04-10 17:01:43.808', 'SA', '230001_add_column_artifacts_deleted_to_stage.sql'),
(230002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.81', TIMESTAMP '2019-04-10 17:01:43.818', 'SA', '230002_populate_missing_completed_by_transition_id.sql'),
(230003, 'DDL', TIMESTAMP '2019-04-10 17:01:43.819', TIMESTAMP '2019-04-10 17:01:43.822', 'SA', '230003_stop_persisting_material_password.sql'),
(230004, 'DDL', TIMESTAMP '2019-04-10 17:01:43.823', TIMESTAMP '2019-04-10 17:01:43.832', 'SA', '230004_add_config_version_to_stage.sql'),
(230005, 'DDL', TIMESTAMP '2019-04-10 17:01:43.833', TIMESTAMP '2019-04-10 17:01:43.834', 'SA', '230005_add_index_bst_buildid_currentstate.sql'),
(230006, 'DDL', TIMESTAMP '2019-04-10 17:01:43.835', TIMESTAMP '2019-04-10 17:01:43.85', 'SA', '230006_make_user_name_case_insensitive.sql'),
(230007, 'DDL', TIMESTAMP '2019-04-10 17:01:43.851', TIMESTAMP '2019-04-10 17:01:43.865', 'SA', '230007_add_completed_time_on_job_and_stage.sql'),
(230008, 'DDL', TIMESTAMP '2019-04-10 17:01:43.866', TIMESTAMP '2019-04-10 17:01:43.868', 'SA', '230008_drop_unique_revisions_for_material_constraint.sql'),
(230009, 'DDL', TIMESTAMP '2019-04-10 17:01:43.869', TIMESTAMP '2019-04-10 17:01:43.871', 'SA', '230009_update_git_material_with_null_branch_to_use_branch_master.sql'),
(240001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.872', TIMESTAMP '2019-04-10 17:01:43.875', 'SA', '240001_add_userid_column_to_pipelineselections.sql'),
(240002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.876', TIMESTAMP '2019-04-10 17:01:43.879', 'SA', '240002_add_disableLicenseExpiryWarning_to_users.sql'),
(300001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.88', TIMESTAMP '2019-04-10 17:01:43.881', 'SA', '300001_add_serverBackup_table.sql'),
(300002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.882', TIMESTAMP '2019-04-10 17:01:43.887', 'SA', '300002_add_pause_info_column.sql'),
(300003, 'DDL', TIMESTAMP '2019-04-10 17:01:43.888', TIMESTAMP '2019-04-10 17:01:43.891', 'SA', '300003_add_serveralias_column_to_material_instance.sql'),
(300004, 'DDL', TIMESTAMP '2019-04-10 17:01:43.892', TIMESTAMP '2019-04-10 17:01:43.894', 'SA', '300004_create_luau_state_table.sql'),
(300005, 'DDL', TIMESTAMP '2019-04-10 17:01:43.895', TIMESTAMP '2019-04-10 17:01:43.897', 'SA', '300005_drop_auth_state_column_from_luau_state.sql'),
(300006, 'DDL', TIMESTAMP '2019-04-10 17:01:43.898', TIMESTAMP '2019-04-10 17:01:43.905', 'SA', '300006_add_tfs_material_attributes.sql'),
(300007, 'DDL', TIMESTAMP '2019-04-10 17:01:43.906', TIMESTAMP '2019-04-10 17:01:43.908', 'SA', '300007_add_display_name_column_to_users.sql'),
(300008, 'DDL', TIMESTAMP '2019-04-10 17:01:43.909', TIMESTAMP '2019-04-10 17:01:43.912', 'SA', '300008_create_luau_groups.sql'),
(300009, 'DDL', TIMESTAMP '2019-04-10 17:01:43.913', TIMESTAMP '2019-04-10 17:01:43.916', 'SA', '300009_add_secure_column_to_environment_variables.sql'),
(300010, 'DDL', TIMESTAMP '2019-04-10 17:01:43.917', TIMESTAMP '2019-04-10 17:01:43.918', 'SA', '300010_add_column_to_store_last_successful_sync_time.sql'),
(300011, 'DDL', TIMESTAMP '2019-04-10 17:01:43.919', TIMESTAMP '2019-04-10 17:01:43.922', 'SA', '300011_remove_column_workspace_owner.sql'),
(1202001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.923', TIMESTAMP '2019-04-10 17:01:43.924', 'SA', '1202001_fix_dependency_material_fingerprint_to_adjust_serveralias.sql'),
(1202002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.925', TIMESTAMP '2019-04-10 17:01:43.927', 'SA', '1202002_add_domain_column_to_material_instance.sql'),
(1202003, 'DDL', TIMESTAMP '2019-04-10 17:01:43.928', TIMESTAMP '2019-04-10 17:01:43.93', 'SA', '1202003_remove_ignore_case_from_domain_column_to_material_instance.sql'),
(1203002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.931', TIMESTAMP '2019-04-10 17:01:43.933', 'SA', '1203002_add_user_column_to_server_backup_table.sql');
INSERT INTO PUBLIC.CHANGELOG(CHANGE_NUMBER, DELTA_SET, START_DT, COMPLETE_DT, APPLIED_BY, DESCRIPTION) VALUES
(1203003, 'DDL', TIMESTAMP '2019-04-10 17:01:43.933', TIMESTAMP '2019-04-10 17:01:43.934', 'SA', '1203003_zap_natural_order_values.sql'),
(1203004, 'DDL', TIMESTAMP '2019-04-10 17:01:43.935', TIMESTAMP '2019-04-10 17:01:43.941', 'SA', '1203004_kill_remote_dependency_material.sql'),
(1203005, 'DDL', TIMESTAMP '2019-04-10 17:01:43.942', TIMESTAMP '2019-04-10 17:01:43.943', 'SA', '1203005_add_index_on_modifications_revision.sql'),
(1301001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.944', TIMESTAMP '2019-04-10 17:01:43.948', 'SA', '1301001_drop_build_event_column_from_builds.sql'),
(1302001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.949', TIMESTAMP '2019-04-10 17:01:43.952', 'SA', '1302001_add_configuration_field_to_materials_table.sql'),
(1303001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.952', TIMESTAMP '2019-04-10 17:01:43.955', 'SA', '1303001_add_additional_data_field_to_modifications_table.sql'),
(1303002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.956', TIMESTAMP '2019-04-10 17:01:43.957', 'SA', '1303002_add_index_to_builds_on_stageId.sql'),
(1303003, 'DDL', TIMESTAMP '2019-04-10 17:01:43.958', TIMESTAMP '2019-04-10 17:01:43.959', 'SA', '1303003_add_index_to_stages_resources_tables.sql'),
(1303004, 'DDL', TIMESTAMP '2019-04-10 17:01:43.96', TIMESTAMP '2019-04-10 17:01:43.962', 'SA', '1303004_indexes_based_on_purge_tool.sql'),
(1304001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.962', TIMESTAMP '2019-04-10 17:01:43.964', 'SA', '1304001_remove_luau_related_entries.sql'),
(1401001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.965', TIMESTAMP '2019-04-10 17:01:43.966', 'SA', '1401001_recreating_trigger_because_of_cruise_to_go_change.sql'),
(1403001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.967', TIMESTAMP '2019-04-10 17:01:43.968', 'SA', '1403001_fix_null_artifacttype_on_artifactplans_table.sql'),
(1403002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.969', TIMESTAMP '2019-04-10 17:01:43.974', 'SA', '1403002_add_runMultipleInstance_column_on_builds_table_recreate_view.sql'),
(1501001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.974', TIMESTAMP '2019-04-10 17:01:43.977', 'SA', '1501001_rename_pipeline_selections_unselected_pipelines_column_to_selections.sql'),
(1501002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.977', TIMESTAMP '2019-04-10 17:01:43.981', 'SA', '1501002_add_comment_column_to_pipelines.sql'),
(1501003, 'DDL', TIMESTAMP '2019-04-10 17:01:43.981', TIMESTAMP '2019-04-10 17:01:43.984', 'SA', '1501003_add_additional_data_field_to_materials_table.sql'),
(1502001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.984', TIMESTAMP '2019-04-10 17:01:43.985', 'SA', '1502001_create_plugins_table.sql'),
(1503001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.985', TIMESTAMP '2019-04-10 17:01:43.988', 'SA', '1503001_remove_licensing_from_users.sql'),
(1503002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.988', TIMESTAMP '2019-04-10 17:01:43.989', 'SA', '1503002_create_version_infos_table.sql'),
(1606001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.989', TIMESTAMP '2019-04-10 17:01:43.99', 'SA', '1606001_add_index_to_buildstatetransitions.sql'),
(1606002, 'DDL', TIMESTAMP '2019-04-10 17:01:43.99', TIMESTAMP '2019-04-10 17:01:43.991', 'SA', '1606002_add_index_to_artifactplans.sql'),
(1607001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.991', TIMESTAMP '2019-04-10 17:01:43.993', 'SA', '1607001_create_agent_metadata_job_table.sql'),
(1610001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.993', TIMESTAMP '2019-04-10 17:01:43.995', 'SA', '1610001_add_index_to_modifiedfiles.sql'),
(1701001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.995', TIMESTAMP '2019-04-10 17:01:43.998', 'SA', '1701001_remove_gadget_oauth_tables.sql'),
(1702001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.998', TIMESTAMP '2019-04-10 17:01:43.999', 'SA', '1702001_remove_build_cause_buffer_table.sql'),
(1704001, 'DDL', TIMESTAMP '2019-04-10 17:01:43.999', TIMESTAMP '2019-04-10 17:01:44.0', 'SA', '1704001_widen_agents_uuid_column.sql'),
(1704002, 'DDL', TIMESTAMP '2019-04-10 17:01:44.001', TIMESTAMP '2019-04-10 17:01:44.001', 'SA', '1704002_widen_builds_agent_uuid_column.sql');
INSERT INTO PUBLIC.CHANGELOG(CHANGE_NUMBER, DELTA_SET, START_DT, COMPLETE_DT, APPLIED_BY, DESCRIPTION) VALUES
(1704003, 'DDL', TIMESTAMP '2019-04-10 17:01:44.002', TIMESTAMP '2019-04-10 17:01:44.009', 'SA', '1704003_pipeline_state_table.sql'),
(1708001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.01', TIMESTAMP '2019-04-10 17:01:44.014', 'SA', '1708001_add_hostname_and_ip_to_agents_table.sql'),
(1801001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.015', TIMESTAMP '2019-04-10 17:01:44.018', 'SA', '1801001_remove_regex_generator_type_from_artifact_properties_generator.sql'),
(1801002, 'DDL', TIMESTAMP '2019-04-10 17:01:44.018', TIMESTAMP '2019-04-10 17:01:44.02', 'SA', '1801002_add_pluggable_artifactconfig_json_to_artifact_plans.sql'),
(1801003, 'DDL', TIMESTAMP '2019-04-10 17:01:44.02', TIMESTAMP '2019-04-10 17:01:44.02', 'SA', '1801003_remove_environment_variables_for_completed_jobs.sql'),
(1801004, 'DDL', TIMESTAMP '2019-04-10 17:01:44.021', TIMESTAMP '2019-04-10 17:01:44.021', 'SA', '1801004_remove_artifact_plans_for_completed_jobs.sql'),
(1801005, 'DDL', TIMESTAMP '2019-04-10 17:01:44.021', TIMESTAMP '2019-04-10 17:01:44.021', 'SA', '1801005_remove_artifact_properties_generator_for_completed_jobs.sql'),
(1801006, 'DDL', TIMESTAMP '2019-04-10 17:01:44.021', TIMESTAMP '2019-04-10 17:01:44.022', 'SA', '1801006_remove_resources_for_completed_jobs.sql'),
(1801007, 'DDL', TIMESTAMP '2019-04-10 17:01:44.022', TIMESTAMP '2019-04-10 17:01:44.022', 'SA', '1801007_remove_job_agent_metadata_for_completed_jobs.sql'),
(1802001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.022', TIMESTAMP '2019-04-10 17:01:44.022', 'SA', '1802001_clear_username_and_comment_for_dependency_materials.sql'),
(1802002, 'DDL', TIMESTAMP '2019-04-10 17:01:44.023', TIMESTAMP '2019-04-10 17:01:44.023', 'SA', '1802002_add_index_on_pipelines_name_and_id_column.sql'),
(1804001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.023', TIMESTAMP '2019-04-10 17:01:44.024', 'SA', '1804001_add_case_insensitive_pipelinename_column_to_pipelinelabelcounts.sql'),
(1805001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.024', TIMESTAMP '2019-04-10 17:01:44.025', 'SA', '1805001_drop_preferred_table.sql'),
(1807001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.025', TIMESTAMP '2019-04-10 17:01:44.025', 'SA', '1807001_data_sharing_settings_table.sql'),
(1807002, 'DDL', TIMESTAMP '2019-04-10 17:01:44.026', TIMESTAMP '2019-04-10 17:01:44.026', 'SA', '1807002_usage_data_reporting_table.sql'),
(1808001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.026', TIMESTAMP '2019-04-10 17:01:44.028', 'SA', '1808001_remove_oauth_tables.sql'),
(1808002, 'DDL', TIMESTAMP '2019-04-10 17:01:44.029', TIMESTAMP '2019-04-10 17:01:44.031', 'SA', '1808002_add_filters_and_version_to_pipeline_selections.sql'),
(1901001, 'DDL', TIMESTAMP '2019-04-10 17:01:44.031', TIMESTAMP '2019-04-10 17:01:44.035', 'SA', '1901001_add_cancelled_by_to_stages_table.sql');
CREATE CACHED TABLE PUBLIC.ARTIFACTPROPERTIESGENERATOR(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_D59DAD6C_A077_475F_BF21_0833E86E1905) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_D59DAD6C_A077_475F_BF21_0833E86E1905,
    JOBID BIGINT,
    NAME VARCHAR(255),
    SRC VARCHAR(512),
    XPATH VARCHAR(512)
);
ALTER TABLE PUBLIC.ARTIFACTPROPERTIESGENERATOR ADD CONSTRAINT PUBLIC.CONSTRAINT_D0 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ARTIFACTPROPERTIESGENERATOR;
CREATE INDEX PUBLIC.IDX_ARTIFACTPROPERTIESGENERATOR_JOBID ON PUBLIC.ARTIFACTPROPERTIESGENERATOR(JOBID);
CREATE CACHED TABLE PUBLIC.PROPERTIES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_6D485518_4624_4E49_8846_9B0D98ED963F) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_6D485518_4624_4E49_8846_9B0D98ED963F,
    BUILDID BIGINT,
    KEY VARCHAR(255),
    VALUE VARCHAR(255)
);
ALTER TABLE PUBLIC.PROPERTIES ADD CONSTRAINT PUBLIC.CONSTRAINT_E PRIMARY KEY(ID);
-- 18 +/- SELECT COUNT(*) FROM PUBLIC.PROPERTIES;
INSERT INTO PUBLIC.PROPERTIES(ID, BUILDID, KEY, VALUE) VALUES
(1, 1, 'cruise_pipeline_label', '1'),
(2, 1, 'cruise_pipeline_counter', '1'),
(3, 1, 'cruise_stage_counter', '1'),
(4, 1, 'cruise_agent', ''),
(5, 1, 'cruise_job_result', 'Cancelled'),
(6, 1, 'cruise_job_duration', '0'),
(7, 1, 'cruise_timestamp_01_scheduled', '2019-04-10T17:03:19-04:00'),
(8, 1, 'cruise_timestamp_06_completed', '2019-04-10T17:03:29-04:00'),
(9, 1, 'cruise_job_id', '1'),
(10, 2, 'cruise_pipeline_label', '2'),
(11, 2, 'cruise_pipeline_counter', '2'),
(12, 2, 'cruise_stage_counter', '1'),
(13, 2, 'cruise_agent', ''),
(14, 2, 'cruise_job_result', 'Cancelled'),
(15, 2, 'cruise_job_duration', '0'),
(16, 2, 'cruise_timestamp_01_scheduled', '2019-04-10T17:05:49-04:00'),
(17, 2, 'cruise_timestamp_06_completed', '2019-04-10T17:05:55-04:00'),
(18, 2, 'cruise_job_id', '2');
CREATE INDEX PUBLIC.IDX_PROPERTIES_KEY ON PUBLIC.PROPERTIES(KEY);
CREATE INDEX PUBLIC.IDX_PROPERTIES_BUILDID ON PUBLIC.PROPERTIES(BUILDID);
CREATE CACHED TABLE PUBLIC.PIPELINELABELCOUNTS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_11D050F4_D2DE_481A_90D0_AF7E4B9A5484) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_11D050F4_D2DE_481A_90D0_AF7E4B9A5484,
    PIPELINENAME VARCHAR(255),
    LABELCOUNT BIGINT,
    PAUSE_CAUSE VARCHAR(255),
    PAUSE_BY VARCHAR(255),
    PAUSED BOOLEAN DEFAULT FALSE,
    CASEINSENSITIVEPIPELINENAME VARCHAR_IGNORECASE(255)
);
ALTER TABLE PUBLIC.PIPELINELABELCOUNTS ADD CONSTRAINT PUBLIC.CONSTRAINT_C7 PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.PIPELINELABELCOUNTS;

---###--- END PART

CREATE INDEX PUBLIC.IDX_PIPELINELABELCOUNTS_PIPELINENAME ON PUBLIC.PIPELINELABELCOUNTS(PIPELINENAME);
CREATE INDEX PUBLIC.IDX_PIPELINELABELCOUNTS_CASEINSENSITIVEPIPELINENAME ON PUBLIC.PIPELINELABELCOUNTS(CASEINSENSITIVEPIPELINENAME);
CREATE CACHED TABLE PUBLIC.RESOURCES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_AD1357FE_A393_4845_8812_964C3301BD20) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_AD1357FE_A393_4845_8812_964C3301BD20,
    NAME VARCHAR(255),
    BUILDID BIGINT NOT NULL
);
ALTER TABLE PUBLIC.RESOURCES ADD CONSTRAINT PUBLIC.CONSTRAINT_2 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.RESOURCES;
CREATE INDEX PUBLIC.IDX_RESOURCES_BUILDID ON PUBLIC.RESOURCES(BUILDID);
CREATE CACHED TABLE PUBLIC.MODIFIEDFILES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_E2899526_367C_49D4_83C8_A973FB1DA871) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_E2899526_367C_49D4_83C8_A973FB1DA871,
    FILENAME VARCHAR(1024),
    REVISION VARCHAR(50),
    FOLDERNAME VARCHAR(512),
    ACTION VARCHAR(50),
    MODIFICATIONID BIGINT NOT NULL
);
ALTER TABLE PUBLIC.MODIFIEDFILES ADD CONSTRAINT PUBLIC.CONSTRAINT_3 PRIMARY KEY(ID);
-- 3 +/- SELECT COUNT(*) FROM PUBLIC.MODIFIEDFILES;
INSERT INTO PUBLIC.MODIFIEDFILES(ID, FILENAME, REVISION, FOLDERNAME, ACTION, MODIFICATIONID) VALUES
(1, 'test_linux.sh', NULL, NULL, 'modified', 1),
(2, 'test_linux_64.sh', NULL, NULL, 'modified', 1),
(3, 'test_mac.sh', NULL, NULL, 'modified', 1);
CREATE CACHED TABLE PUBLIC.NOTIFICATIONFILTERS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_77FF5032_016F_4D53_A95A_A236BBA2DC36) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_77FF5032_016F_4D53_A95A_A236BBA2DC36,
    USERID BIGINT,
    PIPELINE VARCHAR(255),
    STAGE VARCHAR(255),
    EVENT VARCHAR(50),
    MYCHECKIN BOOLEAN
);
ALTER TABLE PUBLIC.NOTIFICATIONFILTERS ADD CONSTRAINT PUBLIC.CONSTRAINT_5 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.NOTIFICATIONFILTERS;
CREATE CACHED TABLE PUBLIC.VERSIONINFOS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_4621E914_4722_4350_BEC2_9C3D2548711C) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_4621E914_4722_4350_BEC2_9C3D2548711C,
    COMPONENTNAME VARCHAR(255) NOT NULL,
    INSTALLEDVERSION VARCHAR(100) NOT NULL,
    LATESTVERSION VARCHAR(50),
    LATESTVERSIONUPDATEDAT TIMESTAMP
);
ALTER TABLE PUBLIC.VERSIONINFOS ADD CONSTRAINT PUBLIC.CONSTRAINT_848 PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.VERSIONINFOS;
INSERT INTO PUBLIC.VERSIONINFOS(ID, COMPONENTNAME, INSTALLEDVERSION, LATESTVERSION, LATESTVERSIONUPDATEDAT) VALUES
(1, 'go_server', '19.1.0-8469', NULL, NULL);
CREATE CACHED TABLE PUBLIC.PIPELINESTATES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_9BF9FCB2_4A4B_4C5E_9765_A038AB75CFC7) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_9BF9FCB2_4A4B_4C5E_9765_A038AB75CFC7,
    PIPELINENAME VARCHAR_IGNORECASE(255) NOT NULL,
    LOCKED BOOLEAN,
    LOCKEDBYPIPELINEID BIGINT
);
ALTER TABLE PUBLIC.PIPELINESTATES ADD CONSTRAINT PUBLIC.CONSTRAINT_6A PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.PIPELINESTATES;
INSERT INTO PUBLIC.PIPELINESTATES(ID, PIPELINENAME, LOCKED, LOCKEDBYPIPELINEID) VALUES
(1, CAST('CreditDriver-Build' AS VARCHAR_IGNORECASE), FALSE, 0);
CREATE FORCE VIEW PUBLIC._STAGES(ID, NAME, APPROVEDBY, PIPELINEID, CREATEDTIME, ORDERID, RESULT, APPROVALTYPE, COUNTER, COMPLETEDBYTRANSITIONID, STATE, LATESTRUN, FETCHMATERIALS, CLEANWORKINGDIR, RERUNOFCOUNTER, ARTIFACTSDELETED, CONFIGVERSION, LASTTRANSITIONEDTIME, PIPELINENAME, BUILDCAUSETYPE, BUILDCAUSEBY, PIPELINELABEL, BUILDCAUSEMESSAGE, PIPELINECOUNTER, LOCKED, NATURALORDER) AS
SELECT
    S.ID,
    S.NAME,
    S.APPROVEDBY,
    S.PIPELINEID,
    S.CREATEDTIME,
    S.ORDERID,
    S.RESULT,
    S.APPROVALTYPE,
    S.COUNTER,
    S.COMPLETEDBYTRANSITIONID,
    S.STATE,
    S.LATESTRUN,
    S.FETCHMATERIALS,
    S.CLEANWORKINGDIR,
    S.RERUNOFCOUNTER,
    S.ARTIFACTSDELETED,
    S.CONFIGVERSION,
    S.LASTTRANSITIONEDTIME,
    P.NAME AS PIPELINENAME,
    P.BUILDCAUSETYPE,
    P.BUILDCAUSEBY,
    P.LABEL AS PIPELINELABEL,
    P.BUILDCAUSEMESSAGE,
    P.COUNTER AS PIPELINECOUNTER,
    PS.LOCKED,
    P.NATURALORDER
FROM PUBLIC.STAGES S
    /* PUBLIC.STAGES.tableScan */
INNER JOIN PUBLIC.PIPELINES P
    /* PUBLIC.PRIMARY_KEY_D: ID = S.PIPELINEID */
    ON 1=1
    /* WHERE P.ID = S.PIPELINEID
    */
LEFT OUTER JOIN PUBLIC.PIPELINESTATES PS
    /* PUBLIC.PIPELINESTATES.tableScan */
    ON PS.LOCKEDBYPIPELINEID = S.PIPELINEID
WHERE P.ID = S.PIPELINEID;
CREATE FORCE VIEW PUBLIC._BUILDS(ID, NAME, STATE, RESULT, AGENTUUID, SCHEDULEDDATE, STAGEID, IGNORED, RUNONALLAGENTS, ORIGINALJOBID, RERUN, RUNMULTIPLEINSTANCE, PIPELINEID, PIPELINENAME, PIPELINELABEL, PIPELINECOUNTER, STAGENAME, STAGECOUNTER, FETCHMATERIALS, CLEANWORKINGDIR, RERUNOFCOUNTER) AS
SELECT
    B.ID,
    B.NAME,
    B.STATE,
    B.RESULT,
    B.AGENTUUID,
    B.SCHEDULEDDATE,
    B.STAGEID,
    B.IGNORED,
    B.RUNONALLAGENTS,
    B.ORIGINALJOBID,
    B.RERUN,
    B.RUNMULTIPLEINSTANCE,
    P.ID AS PIPELINEID,
    P.NAME AS PIPELINENAME,
    P.LABEL AS PIPELINELABEL,
    P.COUNTER AS PIPELINECOUNTER,
    S.NAME AS STAGENAME,
    S.COUNTER AS STAGECOUNTER,
    S.FETCHMATERIALS,
    S.CLEANWORKINGDIR,
    S.RERUNOFCOUNTER
FROM PUBLIC.BUILDS B
    /* PUBLIC.BUILDS.tableScan */
INNER JOIN PUBLIC.STAGES S
    /* PUBLIC.PRIMARY_KEY_D8: ID = B.STAGEID */
    ON 1=1
    /* WHERE S.ID = B.STAGEID
    */
INNER JOIN PUBLIC.PIPELINES P
    /* PUBLIC.PRIMARY_KEY_D: ID = S.PIPELINEID */
    ON 1=1
WHERE (P.ID = S.PIPELINEID)
    AND (S.ID = B.STAGEID);
CREATE CACHED TABLE PUBLIC.PLUGINS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_0BFD76F0_F363_4ADF_9BE4_7EBF92197424) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_0BFD76F0_F363_4ADF_9BE4_7EBF92197424,
    PLUGINID VARCHAR(255) NOT NULL,
    CONFIGURATION TEXT
);
ALTER TABLE PUBLIC.PLUGINS ADD CONSTRAINT PUBLIC.CONSTRAINT_E7 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.PLUGINS;
CREATE CACHED TABLE PUBLIC.BUILDSTATETRANSITIONS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_F9C99765_8C5C_4471_A80F_17ABEE7B4F15) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_F9C99765_8C5C_4471_A80F_17ABEE7B4F15,
    CURRENTSTATE VARCHAR(255) NOT NULL,
    STATECHANGETIME TIMESTAMP NOT NULL,
    BUILDID BIGINT NOT NULL,
    STAGEID BIGINT
);
ALTER TABLE PUBLIC.BUILDSTATETRANSITIONS ADD CONSTRAINT PUBLIC.CONSTRAINT_F2 PRIMARY KEY(ID);
-- 4 +/- SELECT COUNT(*) FROM PUBLIC.BUILDSTATETRANSITIONS;

---###--- END PART

CREATE INDEX PUBLIC.IDX_STATE_TRANSITION ON PUBLIC.BUILDSTATETRANSITIONS(CURRENTSTATE);
CREATE INDEX PUBLIC.IDX_BST_BUILDID_CURRENTSTATE ON PUBLIC.BUILDSTATETRANSITIONS(BUILDID, CURRENTSTATE);
CREATE INDEX PUBLIC.IDX_BUILDSTATETRANSITION_BUILD_ID ON PUBLIC.BUILDSTATETRANSITIONS(BUILDID);
CREATE CACHED TABLE PUBLIC.BUILDS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_16F8250C_9C41_4867_ADF4_0D1E0E7AAF2A) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_16F8250C_9C41_4867_ADF4_0D1E0E7AAF2A,
    NAME VARCHAR_IGNORECASE(255),
    STATE VARCHAR(50),
    RESULT VARCHAR(50),
    AGENTUUID VARCHAR(255),
    SCHEDULEDDATE TIMESTAMP,
    STAGEID BIGINT,
    IGNORED BOOLEAN DEFAULT FALSE,
    RUNONALLAGENTS BOOLEAN DEFAULT FALSE,
    ORIGINALJOBID BIGINT,
    RERUN BOOLEAN DEFAULT FALSE NOT NULL,
    RUNMULTIPLEINSTANCE BOOLEAN DEFAULT FALSE
);
ALTER TABLE PUBLIC.BUILDS ADD CONSTRAINT PUBLIC.CONSTRAINT_7 PRIMARY KEY(ID);
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.BUILDS;

---###--- END PART

CREATE INDEX PUBLIC.IDX_BUILD_STATE ON PUBLIC.BUILDS(STATE);
CREATE INDEX PUBLIC.IDX_BUILD_NAME ON PUBLIC.BUILDS(NAME);
CREATE INDEX PUBLIC.IDX_BUILD_RESULT ON PUBLIC.BUILDS(RESULT);
CREATE INDEX PUBLIC.IDX_BUILD_AGENT ON PUBLIC.BUILDS(AGENTUUID);
CREATE INDEX PUBLIC.IDX_BUILD_IGNORED ON PUBLIC.BUILDS(IGNORED);
CREATE INDEX PUBLIC.IDX_BUILDS_AGENTID_STAGEID_NAME ON PUBLIC.BUILDS(NAME, AGENTUUID, STAGEID, STATE, RESULT);
CREATE INDEX PUBLIC.IDX_BUILDS_NAME_STATE_STAGEID ON PUBLIC.BUILDS(NAME, STATE, STAGEID);
CREATE INDEX PUBLIC.IDX_BUILDS_NAME_STAGE_ID ON PUBLIC.BUILDS(NAME, STAGEID);
CREATE INDEX PUBLIC.IDX_BUILDS_STAGEID ON PUBLIC.BUILDS(STAGEID);
CREATE CACHED TABLE PUBLIC.AGENTS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_DB2104E0_FA01_41B6_B6D6_373CE3C83115) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_DB2104E0_FA01_41B6_B6D6_373CE3C83115,
    UUID VARCHAR(255) NOT NULL,
    COOKIE VARCHAR(40) NOT NULL,
    HOSTNAME VARCHAR(255) DEFAULT NULL,
    IPADDRESS VARCHAR(50) DEFAULT NULL
);
ALTER TABLE PUBLIC.AGENTS ADD CONSTRAINT PUBLIC.CONSTRAINT_72 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.AGENTS;
CREATE INDEX PUBLIC.IDX_AGENT_UUID ON PUBLIC.AGENTS(UUID);
CREATE CACHED TABLE PUBLIC.PIPELINEMATERIALREVISIONS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_A7425CE1_4C3A_478E_8F4B_8A45996C4A3B) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_A7425CE1_4C3A_478E_8F4B_8A45996C4A3B,
    FOLDER VARCHAR(255),
    NAME VARCHAR(255),
    PIPELINEID BIGINT NOT NULL,
    TOREVISIONID BIGINT NOT NULL,
    FROMREVISIONID BIGINT NOT NULL,
    CHANGED BOOLEAN DEFAULT FALSE,
    MATERIALID BIGINT,
    ACTUALFROMREVISIONID BIGINT NOT NULL
);
ALTER TABLE PUBLIC.PIPELINEMATERIALREVISIONS ADD CONSTRAINT PUBLIC.CONSTRAINT_A2 PRIMARY KEY(ID);
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.PIPELINEMATERIALREVISIONS;

---###--- END PART

CREATE INDEX PUBLIC.IDX_PMR_PIPELINE_ID ON PUBLIC.PIPELINEMATERIALREVISIONS(PIPELINEID);
CREATE CACHED TABLE PUBLIC.MATERIALS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_31D4A714_2D67_4C29_B8B6_2620565E132A) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_31D4A714_2D67_4C29_B8B6_2620565E132A,
    TYPE VARCHAR(255),
    URL TEXT,
    USERNAME VARCHAR(255),
    CHECKEXTERNALS BOOLEAN DEFAULT FALSE,
    PIPELINENAME VARCHAR(255),
    STAGENAME VARCHAR(255),
    VIEW TEXT,
    BRANCH TEXT,
    SUBMODULEFOLDER TEXT,
    USETICKETS VARCHAR(10),
    FINGERPRINT CHAR(64) NOT NULL,
    FLYWEIGHTNAME VARCHAR(50) NOT NULL,
    WORKSPACE VARCHAR(255),
    PROJECTPATH VARCHAR(255),
    DOMAIN VARCHAR(255),
    CONFIGURATION TEXT,
    ADDITIONALDATA TEXT
);
ALTER TABLE PUBLIC.MATERIALS ADD CONSTRAINT PUBLIC.CONSTRAINT_4 PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.MATERIALS;
INSERT INTO PUBLIC.MATERIALS(ID, TYPE, URL, USERNAME, CHECKEXTERNALS, PIPELINENAME, STAGENAME, VIEW, BRANCH, SUBMODULEFOLDER, USETICKETS, FINGERPRINT, FLYWEIGHTNAME, WORKSPACE, PROJECTPATH, DOMAIN, CONFIGURATION, ADDITIONALDATA) VALUES
(1, 'GitMaterial', 'https://github.com/arvindsv/faketime.git', NULL, FALSE, NULL, NULL, NULL, 'master', NULL, NULL, '0aa41d38995ff65e435854d94480d95d46cf0405fcc311196a49e82d6c48b7d4', 'f763ef4a-c72f-4a1b-94ba-0648dffce511', NULL, NULL, NULL, NULL, NULL);
CREATE INDEX PUBLIC.IDX_MATERIALS_PIPELINENAME ON PUBLIC.MATERIALS(PIPELINENAME);
CREATE CACHED TABLE PUBLIC.USERS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_8673CDBC_F34A_40FA_B0A9_4EE8412C845D) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_8673CDBC_F34A_40FA_B0A9_4EE8412C845D,
    NAME VARCHAR_IGNORECASE(255) NOT NULL,
    EMAIL VARCHAR(255),
    MATCHER VARCHAR(255),
    EMAILME BOOLEAN DEFAULT FALSE,
    ENABLED BOOLEAN DEFAULT TRUE NOT NULL,
    DISPLAYNAME VARCHAR(255)
);
ALTER TABLE PUBLIC.USERS ADD CONSTRAINT PUBLIC.CONSTRAINT_A PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.USERS;
CREATE CACHED TABLE PUBLIC.STAGES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_C32C24B0_2181_48AE_8C5A_531B7E368282) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_C32C24B0_2181_48AE_8C5A_531B7E368282,
    NAME VARCHAR_IGNORECASE(255),
    APPROVEDBY VARCHAR(255),
    PIPELINEID BIGINT,
    CREATEDTIME TIMESTAMP,
    ORDERID INTEGER NOT NULL,
    RESULT VARCHAR(50) DEFAULT 'Unknown' NOT NULL,
    APPROVALTYPE VARCHAR(255),
    COUNTER INTEGER NOT NULL,
    COMPLETEDBYTRANSITIONID BIGINT,
    STATE VARCHAR(50) DEFAULT 'Unknown' NOT NULL,
    LATESTRUN BOOLEAN DEFAULT FALSE NOT NULL,
    FETCHMATERIALS BOOLEAN DEFAULT TRUE NOT NULL,
    CLEANWORKINGDIR BOOLEAN DEFAULT FALSE NOT NULL,
    RERUNOFCOUNTER INT,
    ARTIFACTSDELETED BOOLEAN DEFAULT FALSE NOT NULL,
    CONFIGVERSION VARCHAR(255),
    LASTTRANSITIONEDTIME TIMESTAMP,
    CANCELLEDBY VARCHAR(255)
);
ALTER TABLE PUBLIC.STAGES ADD CONSTRAINT PUBLIC.CONSTRAINT_9 PRIMARY KEY(ID);
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.STAGES;

---###--- END PART

CREATE INDEX PUBLIC.IDX_STAGE_NAME ON PUBLIC.STAGES(NAME);
CREATE INDEX PUBLIC.IDX_STAGES_ORDERID ON PUBLIC.STAGES(ORDERID);
CREATE INDEX PUBLIC.IDX_STAGES_NAME_PIPELINEID ON PUBLIC.STAGES(NAME, PIPELINEID);
CREATE INDEX PUBLIC.IDX_STAGES_COUNTER_INDEX ON PUBLIC.STAGES(COUNTER);
CREATE INDEX PUBLIC.IDX_STAGES_COMPLETEDBYTRANSITIONID ON PUBLIC.STAGES(COMPLETEDBYTRANSITIONID DESC);
CREATE INDEX PUBLIC.IDX_STAGES_STATE ON PUBLIC.STAGES(STATE);
CREATE INDEX PUBLIC.IDX_STAGES_NAME_LATESTRUN_RESULT ON PUBLIC.STAGES(NAME, LATESTRUN, RESULT);
CREATE INDEX PUBLIC.IDX_STAGES_PIPELINEID ON PUBLIC.STAGES(PIPELINEID);
CREATE CACHED TABLE PUBLIC.MODIFICATIONS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_2A78E877_65C6_495B_98C3_FC214665B25F) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_2A78E877_65C6_495B_98C3_FC214665B25F,
    TYPE VARCHAR(255),
    USERNAME VARCHAR(255),
    COMMENT LONGVARCHAR,
    EMAILADDRESS VARCHAR(255),
    REVISION VARCHAR(1024),
    MODIFIEDTIME TIMESTAMP,
    FROMEXTERNAL BOOLEAN DEFAULT FALSE,
    MATERIALID BIGINT,
    PIPELINELABEL VARCHAR(255),
    PIPELINEID BIGINT,
    ADDITIONALDATA TEXT
);
ALTER TABLE PUBLIC.MODIFICATIONS ADD CONSTRAINT PUBLIC.CONSTRAINT_C8 PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.MODIFICATIONS;
INSERT INTO PUBLIC.MODIFICATIONS(ID, TYPE, USERNAME, COMMENT, EMAILADDRESS, REVISION, MODIFIEDTIME, FROMEXTERNAL, MATERIALID, PIPELINELABEL, PIPELINEID, ADDITIONALDATA) VALUES
(1, NULL, 'Aravind SV <mail@arvindsv.com>', 'Show error on unbound variable (JAVA_HOME)', NULL, 'b49c219dce5231d7e1b78071b2a09cd05383da8c', TIMESTAMP '2019-02-22 06:25:52.0', FALSE, 1, NULL, NULL, NULL);
CREATE INDEX PUBLIC.IDX_MODIFICATIONS_MODIFIEDTIME ON PUBLIC.MODIFICATIONS(MODIFIEDTIME);
CREATE INDEX PUBLIC.IDX_MOD_NEW_MATERIAL_ID ON PUBLIC.MODIFICATIONS(MATERIALID);
CREATE INDEX PUBLIC.IDX_MODIFICATIONS_MATERIALID_ID ON PUBLIC.MODIFICATIONS(MATERIALID, ID);
CREATE INDEX PUBLIC.IDX_MODIFICATIONS_REVISION ON PUBLIC.MODIFICATIONS(REVISION);
CREATE CACHED TABLE PUBLIC.PIPELINESELECTIONS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_CA3CAD59_1BD9_439B_9B57_3F60DB954F32) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_CA3CAD59_1BD9_439B_9B57_3F60DB954F32,
    SELECTIONS LONGVARCHAR,
    LASTUPDATE TIMESTAMP,
    USERID BIGINT,
    ISBLACKLIST BOOLEAN DEFAULT TRUE,
    FILTERS TEXT,
    VERSION INT DEFAULT 0 NOT NULL
);
ALTER TABLE PUBLIC.PIPELINESELECTIONS ADD CONSTRAINT PUBLIC.CONSTRAINT_6 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.PIPELINESELECTIONS;
CREATE CACHED TABLE PUBLIC.PIPELINES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_6BCBD774_62B1_4BEA_8D05_6D361E4F88CD) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_6BCBD774_62B1_4BEA_8D05_6D361E4F88CD,
    NAME VARCHAR_IGNORECASE(255),
    BUILDCAUSETYPE VARCHAR(255),
    BUILDCAUSEBY VARCHAR(255),
    LABEL VARCHAR(255),
    BUILDCAUSEMESSAGE LONGVARCHAR,
    COUNTER BIGINT,
    NATURALORDER DOUBLE DEFAULT 0.0 NOT NULL,
    COMMENT TEXT
);
ALTER TABLE PUBLIC.PIPELINES ADD CONSTRAINT PUBLIC.CONSTRAINT_F PRIMARY KEY(ID);
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.PIPELINES;

---###--- END PART

CREATE INDEX PUBLIC.IDX_PIPELINE_NAME_ID ON PUBLIC.PIPELINES(NAME, ID);
CREATE INDEX PUBLIC.IDX_PIPELINE_NAME ON PUBLIC.PIPELINES(NAME);
CREATE INDEX PUBLIC.IDX_PIPELINE_LABEL ON PUBLIC.PIPELINES(LABEL);
CREATE INDEX PUBLIC.IDX_PIPELINES_NAME_COUNTER ON PUBLIC.PIPELINES(NAME, COUNTER);
CREATE CACHED TABLE PUBLIC.ARTIFACTPLANS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_30D677D9_81BA_48CB_8C8C_1EB13EBF791A) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_30D677D9_81BA_48CB_8C8C_1EB13EBF791A,
    BUILDID BIGINT,
    SRC VARCHAR(255),
    DEST VARCHAR(255),
    ARTIFACTTYPE VARCHAR(255),
    PLUGGABLEARTIFACTCONFIGJSON CLOB DEFAULT NULL
);
ALTER TABLE PUBLIC.ARTIFACTPLANS ADD CONSTRAINT PUBLIC.CONSTRAINT_E1 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ARTIFACTPLANS;
CREATE INDEX PUBLIC.IDX_ARTIFACTPLAN_BUILD_ID ON PUBLIC.ARTIFACTPLANS(BUILDID);
CREATE CACHED TABLE PUBLIC.STAGEARTIFACTCLEANUPPROHIBITED(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_9EC6977A_6B2A_4639_A83D_9854838EBC5B) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_9EC6977A_6B2A_4639_A83D_9854838EBC5B,
    STAGENAME VARCHAR_IGNORECASE(255) NOT NULL,
    PIPELINENAME VARCHAR_IGNORECASE(255) NOT NULL,
    PROHIBITED BOOLEAN DEFAULT FALSE NOT NULL
);
ALTER TABLE PUBLIC.STAGEARTIFACTCLEANUPPROHIBITED ADD CONSTRAINT PUBLIC.CONSTRAINT_8D PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.STAGEARTIFACTCLEANUPPROHIBITED;
CREATE INDEX PUBLIC.IDX_STAGEARTIFACTCLEANUPPROHIBITED_PIPELINENAME ON PUBLIC.STAGEARTIFACTCLEANUPPROHIBITED(PIPELINENAME);
CREATE CACHED TABLE PUBLIC.DATASHARINGSETTINGS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_76F9B884_07A3_4F90_A347_39402C0A5C72) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_76F9B884_07A3_4F90_A347_39402C0A5C72,
    ALLOWSHARING BOOLEAN NOT NULL,
    UPDATEDBY VARCHAR(255),
    UPDATEDON TIMESTAMP
);
ALTER TABLE PUBLIC.DATASHARINGSETTINGS ADD CONSTRAINT PUBLIC.CONSTRAINT_7D PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.DATASHARINGSETTINGS;
INSERT INTO PUBLIC.DATASHARINGSETTINGS(ID, ALLOWSHARING, UPDATEDBY, UPDATEDON) VALUES
(1, TRUE, 'Default', TIMESTAMP '2019-04-10 17:01:50.721');
CREATE CACHED TABLE PUBLIC.USAGEDATAREPORTING(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_AB3E7DF6_D685_45AD_8F38_A6EEA3B818EB) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_AB3E7DF6_D685_45AD_8F38_A6EEA3B818EB,
    SERVERID VARCHAR(255) NOT NULL,
    LASTREPORTEDAT TIMESTAMP
);
ALTER TABLE PUBLIC.USAGEDATAREPORTING ADD CONSTRAINT PUBLIC.CONSTRAINT_3F PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.USAGEDATAREPORTING;
INSERT INTO PUBLIC.USAGEDATAREPORTING(ID, SERVERID, LASTREPORTEDAT) VALUES
(1, 'f6f1e0b3-2e66-419e-bad3-6ad0904c4065', TIMESTAMP '1969-12-31 19:00:00.0');
CREATE CACHED TABLE PUBLIC.SERVERBACKUPS(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_735ED142_BD5A_4A5D_A206_3F947F7C87BF) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_735ED142_BD5A_4A5D_A206_3F947F7C87BF,
    PATH VARCHAR(2048),
    TIME TIMESTAMP,
    USERNAME VARCHAR_IGNORECASE(255)
);
ALTER TABLE PUBLIC.SERVERBACKUPS ADD CONSTRAINT PUBLIC.CONSTRAINT_7B PRIMARY KEY(ID);
-- 1 +/- SELECT COUNT(*) FROM PUBLIC.SERVERBACKUPS;
INSERT INTO PUBLIC.SERVERBACKUPS(ID, PATH, TIME, USERNAME) VALUES
(1, '/Users/aravindsv/projects/go/gocd/installers/target/distributions/zip/go-server-19.1.0/artifacts/serverBackups/backup_20190410-170529', TIMESTAMP '2019-04-10 17:05:29.754', CAST('anonymous' AS VARCHAR_IGNORECASE));
CREATE CACHED TABLE PUBLIC.ENVIRONMENTVARIABLES(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_6FE8DA54_7879_4B40_B9BB_6FEB68DC347C) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_6FE8DA54_7879_4B40_B9BB_6FEB68DC347C,
    ENTITYID BIGINT,
    VARIABLENAME VARCHAR(255),
    VARIABLEVALUE TEXT,
    ENTITYTYPE VARCHAR(100) NOT NULL,
    ISSECURE BOOLEAN DEFAULT FALSE
);
ALTER TABLE PUBLIC.ENVIRONMENTVARIABLES ADD CONSTRAINT PUBLIC.CONSTRAINT_E6 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.ENVIRONMENTVARIABLES;
CREATE INDEX PUBLIC.IDX_ENVIRONMENTVARIABLES_ENTITYTYPE ON PUBLIC.ENVIRONMENTVARIABLES(ENTITYTYPE);
CREATE INDEX PUBLIC.IDX_ENV_JOB_ID ON PUBLIC.ENVIRONMENTVARIABLES(ENTITYID);
CREATE CACHED TABLE PUBLIC.JOBAGENTMETADATA(
    ID BIGINT DEFAULT (NEXT VALUE FOR PUBLIC.SYSTEM_SEQUENCE_70301CFF_3E94_4F4F_9584_20786524A18F) NOT NULL NULL_TO_DEFAULT SEQUENCE PUBLIC.SYSTEM_SEQUENCE_70301CFF_3E94_4F4F_9584_20786524A18F,
    JOBID BIGINT NOT NULL,
    METADATA CLOB NOT NULL,
    METADATAVERSION VARCHAR(50)
);
ALTER TABLE PUBLIC.JOBAGENTMETADATA ADD CONSTRAINT PUBLIC.CONSTRAINT_25 PRIMARY KEY(ID);
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.JOBAGENTMETADATA;
ALTER TABLE PUBLIC.PLUGINS ADD CONSTRAINT PUBLIC.CONSTRAINT_E72 UNIQUE(PLUGINID);
ALTER TABLE PUBLIC.ARTIFACTPROPERTIESGENERATOR ADD CONSTRAINT PUBLIC.CONSTRAINT_D09 UNIQUE(JOBID, NAME);
ALTER TABLE PUBLIC.AGENTS ADD CONSTRAINT PUBLIC.CONSTRAINT_72F UNIQUE(UUID);
ALTER TABLE PUBLIC.USERS ADD CONSTRAINT PUBLIC.UNIQUE_NAME UNIQUE(NAME);
ALTER TABLE PUBLIC.PROPERTIES ADD CONSTRAINT PUBLIC.CONSTRAINT_E5 UNIQUE(BUILDID, KEY);
ALTER TABLE PUBLIC.PIPELINELABELCOUNTS ADD CONSTRAINT PUBLIC.UNIQUE_PIPELINE_NAME UNIQUE(PIPELINENAME);
ALTER TABLE PUBLIC.AGENTS ADD CONSTRAINT PUBLIC.CONSTRAINT_72F4 UNIQUE(COOKIE);
ALTER TABLE PUBLIC.MATERIALS ADD CONSTRAINT PUBLIC.UNIQUE_FINGERPRINT UNIQUE(FINGERPRINT);
ALTER TABLE PUBLIC.PIPELINESTATES ADD CONSTRAINT PUBLIC.UNIQUE_PIPELINE_STATE UNIQUE(PIPELINENAME);
ALTER TABLE PUBLIC.MATERIALS ADD CONSTRAINT PUBLIC.MATERIALS_FLYWEIGHTNAME_UNIQUE UNIQUE(FLYWEIGHTNAME);
ALTER TABLE PUBLIC.VERSIONINFOS ADD CONSTRAINT PUBLIC.CONSTRAINT_848D UNIQUE(COMPONENTNAME);
ALTER TABLE PUBLIC.STAGES ADD CONSTRAINT PUBLIC.UNIQUE_PIPELINE_ID_NAME_COUNTER UNIQUE(PIPELINEID, NAME, COUNTER);
ALTER TABLE PUBLIC.JOBAGENTMETADATA ADD CONSTRAINT PUBLIC.CONSTRAINT_25E UNIQUE(JOBID);
ALTER TABLE PUBLIC.ARTIFACTPLANS ADD CONSTRAINT PUBLIC.FK_ARTIFACTPLANS_BUILDS FOREIGN KEY(BUILDID) REFERENCES PUBLIC.BUILDS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.STAGES ADD CONSTRAINT PUBLIC.FK_STAGES_PIPELINES FOREIGN KEY(PIPELINEID) REFERENCES PUBLIC.PIPELINES(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.MODIFIEDFILES ADD CONSTRAINT PUBLIC.FK_MODIFIEDFILES_MODIFICATIONS FOREIGN KEY(MODIFICATIONID) REFERENCES PUBLIC.MODIFICATIONS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.PIPELINESELECTIONS ADD CONSTRAINT PUBLIC.FK_PIPELINESELECTIONS_USERID FOREIGN KEY(USERID) REFERENCES PUBLIC.USERS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.ARTIFACTPROPERTIESGENERATOR ADD CONSTRAINT PUBLIC.FK_ARTIFACTPROPERTIESGENERATOR_JOBS FOREIGN KEY(JOBID) REFERENCES PUBLIC.BUILDS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.PIPELINEMATERIALREVISIONS ADD CONSTRAINT PUBLIC.FK_PMR_ACTUALFROMREVISIONID FOREIGN KEY(ACTUALFROMREVISIONID) REFERENCES PUBLIC.MODIFICATIONS(ID) NOCHECK;
ALTER TABLE PUBLIC.RESOURCES ADD CONSTRAINT PUBLIC.FK_RESOURCES_BUILDS FOREIGN KEY(BUILDID) REFERENCES PUBLIC.BUILDS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.PIPELINEMATERIALREVISIONS ADD CONSTRAINT PUBLIC.FK_PMR_PIPELINE FOREIGN KEY(PIPELINEID) REFERENCES PUBLIC.PIPELINES(ID) NOCHECK;
ALTER TABLE PUBLIC.MODIFICATIONS ADD CONSTRAINT PUBLIC.FK_MODIFICATIONS_PIPELINEID FOREIGN KEY(PIPELINEID) REFERENCES PUBLIC.PIPELINES(ID) NOCHECK;
ALTER TABLE PUBLIC.PIPELINEMATERIALREVISIONS ADD CONSTRAINT PUBLIC.FK_PMR_FROM_REVISION FOREIGN KEY(FROMREVISIONID) REFERENCES PUBLIC.MODIFICATIONS(ID) NOCHECK;
ALTER TABLE PUBLIC.BUILDS ADD CONSTRAINT PUBLIC.FK_BUILDS_STAGES FOREIGN KEY(STAGEID) REFERENCES PUBLIC.STAGES(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.BUILDSTATETRANSITIONS ADD CONSTRAINT PUBLIC.FK_BUILDTRANSITIONS_STAGES FOREIGN KEY(STAGEID) REFERENCES PUBLIC.STAGES(ID) NOCHECK;
ALTER TABLE PUBLIC.PIPELINEMATERIALREVISIONS ADD CONSTRAINT PUBLIC.FK_PMR_MATERIALID FOREIGN KEY(MATERIALID) REFERENCES PUBLIC.MATERIALS(ID) NOCHECK;
ALTER TABLE PUBLIC.JOBAGENTMETADATA ADD CONSTRAINT PUBLIC.FK_JOBAGENTMETADATA_JOBS FOREIGN KEY(JOBID) REFERENCES PUBLIC.BUILDS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.PIPELINEMATERIALREVISIONS ADD CONSTRAINT PUBLIC.FK_PMR_TO_REVISION FOREIGN KEY(TOREVISIONID) REFERENCES PUBLIC.MODIFICATIONS(ID) NOCHECK;
ALTER TABLE PUBLIC.BUILDSTATETRANSITIONS ADD CONSTRAINT PUBLIC.FK_BUILDSTATETRANSITIONS_BUILDS FOREIGN KEY(BUILDID) REFERENCES PUBLIC.BUILDS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.NOTIFICATIONFILTERS ADD CONSTRAINT PUBLIC.FK_NOTIFICATIONFILTERS_USERS FOREIGN KEY(USERID) REFERENCES PUBLIC.USERS(ID) ON DELETE CASCADE NOCHECK;
ALTER TABLE PUBLIC.PROPERTIES ADD CONSTRAINT PUBLIC.FK_PROPERTIES_BUILDS FOREIGN KEY(BUILDID) REFERENCES PUBLIC.BUILDS(ID) ON DELETE CASCADE NOCHECK;
CREATE FORCE TRIGGER PUBLIC.LASTTRANSITIONEDTIMEUPDATE AFTER INSERT ON PUBLIC.BUILDSTATETRANSITIONS FOR EACH ROW QUEUE 1024 CALL "com.thoughtworks.go.server.sqlmigration.Migration_230007";
